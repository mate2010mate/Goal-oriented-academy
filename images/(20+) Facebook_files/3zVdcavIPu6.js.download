;/*FB_PKG_DELIM*/

__d("CappedListItemTracker.react",["CappedListItemContext","emptyFunction","react","useVisibilityObserver"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;b.useMemo;var j=b.c;function a(a){var b=j(18),d=a.cappedItemIDs,e=a.children,f=a.id,g=a.onItemOffScreen,h=a.onItemOnScreen,k=a.registerBlocker;b[0]!==g||b[1]!==f?(a=function(){g==null?void 0:g(f)},b[0]=g,b[1]=f,b[2]=a):a=b[2];a=a;var l;b[3]!==h||b[4]!==f?(l=function(){h==null?void 0:h(f)},b[3]=h,b[4]=f,b[5]=l):l=b[5];l=l;var m;b[6]!==a||b[7]!==l?(m={onHidden:a,onVisible:l},b[6]=a,b[7]=l,b[8]=m):m=b[8];a=c("useVisibilityObserver")(m);b[9]!==k||b[10]!==f?(l={registerBlocker:function(a){return(k==null?void 0:k(f,a))||c("emptyFunction")}},b[9]=k,b[10]=f,b[11]=l):l=b[11];m=l;l=m;d=(m=d==null?void 0:d.has(f))!=null?m:!1;if(d)return null;!g&&!h&&(a=c("emptyFunction"));b[12]!==l||b[13]!==e?(m=i.jsx(c("CappedListItemContext").Provider,{value:l,children:e}),b[12]=l,b[13]=e,b[14]=m):m=b[14];b[15]!==a||b[16]!==m?(d=i.jsx("div",{ref:a,children:m}),b[15]=a,b[16]=m,b[17]=d):d=b[17];return d}g["default"]=a}),98);
__d("CappedListItemTrackerMock.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(2);a=a.children;var c;b[0]!==a?(c=j.jsx("div",{children:a}),b[0]=a,b[1]=c):c=b[1];return c}g["default"]=a}),98);
__d("useCometCappedListMock",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c,d,e){return null}f["default"]=a}),66);
__d("cometCappedListFactory",["CappedListItemTrackerMock.react","FBLogger","cr:26","cr:2717","useCometCappedListMock"],(function(a,b,c,d,e,f,g){"use strict";var h=(d=b("cr:26"))!=null?d:c("useCometCappedListMock"),i=(e=b("cr:2717"))!=null?e:c("CappedListItemTrackerMock.react");function a(a){a=h!==c("useCometCappedListMock")&&j()&&!((a=a==null?void 0:a())!=null?a:!1);return{CappedListItemTracker:a?i:c("CappedListItemTrackerMock.react"),useCometCappedList:a?h:c("useCometCappedListMock")}}function j(){try{var a;a=(a=window)==null?void 0:a.CSS;return(a==null?void 0:a.supports==null?void 0:a.supports("overflow-anchor","auto"))===!0}catch(a){c("FBLogger")("comet_performance.memory").catching(a).mustfix("Unable to detect if browser supports scroll anchoring");return!1}}g["default"]=a}),98);
__d("useCometCappedList",["FBLogger","emptyFunction","forEachObject","justknobx","react","useDebouncedComet"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.useDeferredValue,j=b.useEffect,k=b.useInsertionEffect;b.useMemo;var l=b.useRef,m=b.useState,n=b.c,o=1e3;function a(a,b,d,e,f){var g=n(40),h;g[0]!==e?(h=e===void 0?c("justknobx")._("1013"):e,g[0]=e,g[1]=h):h=g[1];var v=h,w=f===void 0?5:f;g[2]===Symbol["for"]("react.memo_cache_sentinel")?(e=new Set(),g[2]=e):e=g[2];h=m(e);f=h[0];var x=h[1],y=i(f);g[3]===Symbol["for"]("react.memo_cache_sentinel")?(e={},g[3]=e):e=g[3];var z=l(e),A=l(a);g[4]!==w||g[5]!==d||g[6]!==b||g[7]!==v||g[8]!==y?(h=function(){z.current=p({cappedListInfo:z.current,dontUnmountItemsNearOnScreenOnes:w,fullList:A.current,getItemID:d,maxLength:b,minOffscreenDurationBeforeUnmount:v}),x(r(y,z.current))},g[4]=w,g[5]=d,g[6]=b,g[7]=v,g[8]=y,g[9]=h):h=g[9];g[10]===Symbol["for"]("react.memo_cache_sentinel")?(f={wait:o},g[10]=f):f=g[10];var B=c("useDebouncedComet")(h,f);g[11]!==B?(e=function(){B()},g[11]=B,g[12]=e):e=g[12];var C=e;g[13]===Symbol["for"]("react.memo_cache_sentinel")?(h=[],g[13]=h):h=g[13];var D=l(h);g[14]===Symbol["for"]("react.memo_cache_sentinel")?(f={},g[14]=f):f=g[14];e=m(f);var E=e[0],F=e[1];g[15]!==C?(h=function(a,b,c){if(c&&s(z.current,a)==null){D.current.push({id:a,isOnScreen:b});F({});return}z.current=t(z.current,a,b);C()},g[15]=C,g[16]=h):h=g[16];var G=h;g[17]!==G?(f=function(a,b){b=b===void 0?!0:b;G(a,!1,b)},g[17]=G,g[18]=f):f=g[18];var H=f;g[19]!==G?(e=function(a,b){b=b===void 0?!0:b;G(a,!0,b)},g[19]=G,g[20]=e):e=g[20];var I=e;g[21]!==a||g[22]!==d?(h=function(){A.current=a,z.current=q(d,z.current,a)},g[21]=a,g[22]=d,g[23]=h):h=g[23];var J=h;g[24]!==J?(f=function(){J()},e=[J],g[24]=J,g[25]=f,g[26]=e):(f=g[25],e=g[26]);k(f,e);g[27]!==E||g[28]!==J||g[29]!==I||g[30]!==H?(h=function(){var a=D.current;if(E&&a.length){c("FBLogger")("comet_performance.memory","useCometCappedList").mustfix("Processing %s manual visibility updates although it shouldn't happen: %s",a.length,JSON.stringify(a));J();var b=a.length;a.forEach(function(a){var b=a.id;a=a.isOnScreen;a?I(b,!1):H(b,!1)});a.splice(0,b)}},f=[E,H,I,J],g[27]=E,g[28]=J,g[29]=I,g[30]=H,g[31]=h,g[32]=f):(h=g[31],f=g[32]);j(h,f);g[33]===Symbol["for"]("react.memo_cache_sentinel")?(e=function(a,b){return u(z.current,a,b)},g[33]=e):e=g[33];h=e;g[34]!==b||g[35]!==y||g[36]!==H||g[37]!==I||g[38]!==h?(f=b>0?{cappedItemIDs:y,onItemOffScreen:H,onItemOnScreen:I,registerBlocker:h}:null,g[34]=b,g[35]=y,g[36]=H,g[37]=I,g[38]=h,g[39]=f):f=g[39];e=f;return e}function p(a){var b=a.cappedListInfo,d=a.dontUnmountItemsNearOnScreenOnes,e=a.fullList,f=a.getItemID,g=a.maxLength;a=a.minOffscreenDurationBeforeUnmount;if(g<=0)return b;var h=new Set();e=e.map(function(a){a=f(a);var c=s(b,a);if(c==null){h.add(a);return null}return{id:a,info:c}}).filter(Boolean).filter(function(a){return!a.info.isCapped});if(h.size>0){c("FBLogger")("comet_performance.memory","useCometCappedList").mustfix("Unable to apply capping rules because we couldn't find info for items: %s",JSON.stringify(Array.from(h)));return b}var i=Date.now();g=e.length-g;var j=e.findIndex(function(a){a=a.info;return a.isOnScreen});if(j<0)return b;var k;for(var l=0;g>0&&l<e.length;l++){var m=e[l],n=m.id;m=m.info;if(l+d>=j)break;if(m.lastTimeVisible!=null&&i-m.lastTimeVisible<=a)break;if(m.blockers&&m.blockers.size>0)break;if(m.isOnScreen===!0)break;k==null&&(k=babelHelpers["extends"]({},b));Object.prototype.hasOwnProperty.call(k,n)||c("FBLogger")("comet_performance.memory","newsfeed").mustfix("Unable to find capped item context data for id=%s, this should never happen",JSON.stringify(n));k[n]=babelHelpers["extends"]({},m,{isCapped:!0});g--}return k||b}function q(a,b,c){var d;c.forEach(function(c){c=a(c);Object.prototype.hasOwnProperty.call(b,c)||(d==null&&(d=babelHelpers["extends"]({},b)),d[c]={blockers:null,isCapped:!1,isOnScreen:null,lastTimeVisible:null})});return d||b}function r(a,b){var d=null;c("forEachObject")(b,function(b,c){b.isCapped&&!a.has(c)&&(d==null&&(d=new Set(a)),d.add(c))});return d||a}function s(a,b,d){d===void 0&&(d=!1);a=a[b];if(d&&a==null){c("FBLogger")("comet_performance.memory","useCometCappedList").mustfix("Unable to find capped item info [id=%s]",JSON.stringify(b));return}return a}function t(a,b,d){var e=s(a,b);if(e==null){c("FBLogger")("comet_performance.memory","useCometCappedList").warn("Unable to set visibility [isOnScreen=%s] for item [id=%s]",d,JSON.stringify(b));return a}e=babelHelpers["extends"]({},e,{isOnScreen:d,lastTimeVisible:Date.now()});return babelHelpers["extends"]({},a,(d={},d[b]=e,d))}function u(a,b,d){var e=s(a,b,!0);if(e==null)return c("emptyFunction");e.blockers?e.blockers.add(d):e.blockers=new Set([d]);return function(){var e,f=s(a,b,!0);if(f&&((e=f.blockers)==null?void 0:e["delete"](d))){((e=f.blockers)==null?void 0:e.size)===0&&(f.blockers=null)}else c("FBLogger")("comet_performance.memory","useCometCappedList").mustfix("Unable to delete capped-item blocker [id=%s][blocker=%s]",JSON.stringify(b),JSON.stringify(d))}}g["default"]=a}),98);