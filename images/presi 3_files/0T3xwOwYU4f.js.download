;/*FB_PKG_DELIM*/

__d("MWXErrorBlock.react",["MWXButton.react","MWXColumn.react","MWXColumnItem.react","MWXImage.react","MWXTextPairing.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=a.align;b=b===void 0?"center":b;var d=a.error,e=a.level;a=a.showImage;a=a===void 0?!0:a;var f=d.action,g=d.body,h=d.headline;d=d.image;return i.jsxs(c("MWXColumn.react"),{align:b,spacing:12,children:[a&&d!=null&&i.jsx(c("MWXColumnItem.react"),{children:i.jsx(c("MWXImage.react"),{src:d})}),i.jsx(c("MWXColumnItem.react"),{paddingTop:16,children:i.jsx(c("MWXTextPairing.react"),{body:g,bodyColor:"secondary",headline:h,level:e?e:2,textAlign:b})}),f!=null&&i.jsx(c("MWXColumnItem.react"),{align:"stretch",paddingVertical:16,children:i.jsx(c("MWXColumnItem.react"),{paddingVertical:16,children:i.jsx(c("MWXButton.react"),{label:f.label,onPress:f.onPress,padding:"wide",size:36})})})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("ReStoreDBCorruption",[],(function(a,b,c,d,e,f){"use strict";var g="Got unexpected undefined",h="ReStoreDBCorruption";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c,d=g+", table: "+b;c=a.call(this,d)||this;c.message=d;c.name=h;c.tableName=b;return c}return b}(babelHelpers.wrapNativeSuper(Error));f.ERROR_NAME=h;f.ReStoreDBCorruption=a}),66);
__d("getMWErrorDefinition",["fbt","ix","MAWUnrecoverableDbErrors","MWDeleteAllDBs","ReStoreDBCorruption","ReStoreDbVersionChange","ReStoreDecryptionFailure","ReStoreEARSetupFailure","cr:6883","gkx","isArmadillo","promiseDone"],(function(a,b,c,d,e,f,g,h,i){"use strict";function a(a,e,f){f===void 0&&(f=!0);f=f?2:1;var g={action:{label:h._("__JHASH__DOoRvZWfN9Q__JHASH__"),onPress:function(){window.location.reload(!0)}},autoRefresh:"never",body:h._("__JHASH__iQVounN-Hch__JHASH__"),headline:h._("__JHASH__vJj0Hk9D_-R__JHASH__",[h._plural(f)]),image:c("gkx")("23219")?e==="light"?i("210379"):i("210377"):i("433676")},j=a.messageFormat||"";if(!c("gkx")("24032")&&(a instanceof d("ReStoreDecryptionFailure").ReStoreDecryptionFailure||a instanceof d("ReStoreEARSetupFailure").ReStoreEARSetupFailure)){var k={label:g.action.label,onPress:function(){c("MWDeleteAllDBs")("error")["finally"](g.action.onPress)}};return c("isArmadillo")()?babelHelpers["extends"]({},g,{action:k,body:h._("__JHASH__U5NUnUf9KdD__JHASH__",[h._plural(f)]),headline:h._("__JHASH__ee6MA3uWv7t__JHASH__")}):babelHelpers["extends"]({},g,{action:k})}else if(a instanceof d("ReStoreDBCorruption").ReStoreDBCorruption||a.name===d("ReStoreDBCorruption").ERROR_NAME||j.includes(d("ReStoreDBCorruption").ERROR_NAME))return babelHelpers["extends"]({},g,{action:{label:g.action.label,onPress:b("cr:6883")!=null?function(){b("cr:6883").deleteIndexedDB("error")["finally"](g.action.onPress)}:g.action.onPress}});else if(a instanceof d("ReStoreDbVersionChange").ReStoreDbVersionChange||a.name===d("ReStoreDbVersionChange").ERROR_NAME||j.includes(d("ReStoreDbVersionChange").ERROR_NAME))return babelHelpers["extends"]({},g,{autoRefresh:"background",body:h._("__JHASH__plrZEdqhq2n__JHASH__",[h._plural(f)]),headline:h._("__JHASH__0a79Vl-Ytg3__JHASH__",[h._plural(f)]),image:c("gkx")("23219")?e==="light"?i("210437"):i("210435"):i("433676")});else if(a instanceof d("MAWUnrecoverableDbErrors").UnrecoverableDbError)return babelHelpers["extends"]({},g,{action:babelHelpers["extends"]({},g.action,{label:h._("__JHASH__LiLFo9P7Z2y__JHASH__"),onPress:function(){c("promiseDone")(c("MWDeleteAllDBs")("error"),function(){g.action.onPress()})}}),body:h._("__JHASH__Hg8XBFMDRr1__JHASH__",[h._plural(f)])});else return g}g["default"]=a}),226);
__d("MWErrorBlock.react",["FBLogger","LSPlatformLsInitLog","MWXErrorBlock.react","ODS","ReStoreDbVersionChange","getMWErrorDefinition","react","useCurrentDisplayMode"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||(h=d("react"));b=h;var k=b.useEffect,l=b.useMemo;function m(a){a instanceof d("ReStoreDbVersionChange").ReStoreDbVersionChange?c("FBLogger")("messenger_web_product").info(a.toString()):c("FBLogger")("messenger_web_product").catching(a).mustfix("Uncaught Error while loading chat: %s",a.toString())}function a(a){var b=a.canTriggerAutoReload,e=a.error,f=a.plural,g=a.source;a=babelHelpers.objectWithoutPropertiesLoose(a,["canTriggerAutoReload","error","plural","source"]);var h=c("useCurrentDisplayMode")(),n=l(function(){return c("getMWErrorDefinition")(e,h,f)},[e,f,h]),o=n.autoRefresh,p=babelHelpers.objectWithoutPropertiesLoose(n,["autoRefresh"]);k(function(){d("LSPlatformLsInitLog").addAnnotations({string:{uncaught_error:e.name}}),d("LSPlatformLsInitLog").fail("uncaught_error"),m(e)},[e]);k(function(){b===!0&&o==="background"&&document.visibilityState==="hidden"&&window.location.reload(!0)},[o,b,e]);k(function(){(i||(i=d("ODS"))).bumpEntityKey(3303,"mw_error_block",g+"."+e.name)},[e.name,g]);n=l(function(){return p.action!=null?babelHelpers["extends"]({},p,{action:babelHelpers["extends"]({},p.action,{onPress:function(){var a;(i||(i=d("ODS"))).bumpEntityKey(3303,"mw_error_block",g+"."+e.name+".action");(a=p.action)==null?void 0:a.onPress()}})}):p},[e.name,p,g]);return j.jsx(c("MWXErrorBlock.react"),babelHelpers["extends"]({},a,{error:n}))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWInboxErrorState.react",["CometHeroFailTrigger.react","CometSection.react","MWErrorBlock.react","MWXColumn.react","MWXColumnItem.react","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j={mdsRoot:{alignItems:"x6s0dn4",backgroundColor:"x2bj2ny",display:"x78zum5",height:"x1dr59a3",justifyContent:"xl56j7k",width:"xh8yej3",$$css:!0}};function a(a){var b=a.canTriggerAutoReload,d=a.error,e=a.plural,f=a.source;a=a.xstyle;return i.jsx(c("MWXColumn.react"),{paddingHorizontal:16,verticalAlign:"center",xstyle:[c("gkx")("23219")&&j.mdsRoot,a],children:i.jsxs(c("MWXColumnItem.react"),{children:[i.jsx(c("CometHeroFailTrigger.react"),{description:"Inbox load failed",error:d,fail:!0}),i.jsx(c("CometSection.react"),{className:"xxc7z9f",role:"main",children:i.jsx(c("MWErrorBlock.react"),{canTriggerAutoReload:b,error:d,plural:e,source:f})})]})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("CometMessagingChatTabErrorState.react",["MWInboxErrorState.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j={cardWidth:{width:"x1cvmir6",$$css:!0},errorBoundary:{height:"x5yr21d",$$css:!0}};function a(a){a=a.error;return i.jsx(c("MWInboxErrorState.react"),{error:a,plural:!1,source:"fb_chat_tab",xstyle:[j.cardWidth,j.errorBoundary]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("LSLocalCreateOptimisticGroupThreadStoredProcedure",["LSLocalCreateOptimisticGroupThread","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.participants;d[1]=b.nullstateDescriptionText;d[2]=b.threadName;d[3]=b.checkExistingThreads;d[4]=b.threadMetadata;return c("LSLocalCreateOptimisticGroupThread").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MAWCreateOptimisticSecureThread",["I64","LSAuthorityLevel","LSFactory","LSGroupParticipantJoinState","LSIntEnum","LSVerifyE2EEMetadataThreadExistsV2StoredProcedure","Promise","ReQLTable","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,b){return c("LSVerifyE2EEMetadataThreadExistsV2StoredProcedure")(c("LSFactory")(a),{authorityLevel:(j||(j=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC),threadType:b}).then(function(b){var e=b[0];return d("ReQLTable").update(a.threads,[e],function(a){if(a==null)throw c("unrecoverableViolation")("Optimistic thread is missing","messenger_web_messaging");return babelHelpers["extends"]({},a,{clientThreadKey:e})}).then(function(){return e})})}function a(a,e,f){return k(a,f).then(function(f){return(h||(h=b("Promise"))).all(e.map(function(b){return a.participants.add({authorityLevel:(j||(j=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC),contactId:b.id,deliveredWatermarkTimestampMs:(i||(i=d("I64"))).zero,groupParticipantJoinState:j.ofNumber(c("LSGroupParticipantJoinState").MEMBER),isAdmin:void 0,isModerator:!1,isSuperAdmin:void 0,nickname:void 0,normalizedSearchTerms:void 0,participantCapabilities:void 0,readActionTimestampMs:i.zero,readWatermarkTimestampMs:i.zero,subscribeSource:void 0,threadKey:f})})).then(function(){return f})})}g.call=a}),98);
__d("MWEBChatTabBannerNuxQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="8795529810476139"}),null);
__d("MWEBChatTabBannerNuxQuery.graphql",["MWEBChatTabBannerNuxQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MWEBChatTabBannerNuxQuery",selections:[{args:null,kind:"FragmentSpread",name:"useEncryptedBackupsProcessStatePreLoaded_query"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"MWEBChatTabBannerNuxQuery",selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"xfb_backup",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"backup_state",storageKey:null}]}],storageKey:null}]},params:{id:b("MWEBChatTabBannerNuxQuery_facebookRelayOperation"),metadata:{},name:"MWEBChatTabBannerNuxQuery",operationKind:"query",text:null}};e.exports=a}),null);
__d("MWEBChatTabBannerNux.react",["CometPlaceholder.react","MWChatEncryptedBackupsQPLSource.enum","MWEBChatTabBannerNuxQuery.graphql","MWEBEntrypointsKillswitch.enum","RelayHooks","cr:10252","react","useEncryptedBackupsProcessStatePreLoaded"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react");function k(){var a=d("RelayHooks").useLazyLoadQuery(h!==void 0?h:h=b("MWEBChatTabBannerNuxQuery.graphql"),{},{fetchPolicy:"store-or-network"});a=c("useEncryptedBackupsProcessStatePreLoaded")({entrypoint:c("MWEBEntrypointsKillswitch.enum").NOT_AN_ENTRYPOINT_NO_KILLSWITCH_APPLICABLE,query:a});switch(a){case 2:return b("cr:10252")&&j.jsx(b("cr:10252"),{children:null,source:c("MWChatEncryptedBackupsQPLSource.enum").CHAT_TAB_ONBOARDING_QP});default:return null}}k.displayName=k.name+" [from "+f.id+"]";function a(){return j.jsx(c("CometPlaceholder.react"),{fallback:null,children:j.jsx(k,{})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWInThreadBannerNuxReqCondWrapper.react",["CometPlaceholder.react","MWEBChatTabBannerNux.react","cr:9715","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(){if(b("cr:9715")&&c("gkx")("1778"))return i.jsx(c("CometPlaceholder.react"),{fallback:null,children:i.jsx(b("cr:9715"),{hasNoMargin:!0})});else return i.jsx(c("MWEBChatTabBannerNux.react"),{})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWCMSubThreadChatTabWithSubthread.react",["BaseMultiStepContainer.react","CometPlaceholder.react","MWCMSubthreadChatTabContext.react","MWRelayChatTabHeaderRoot.react","MWV2ChatTabLoadingWithGlimmers.react","MWV2TabContainer","deferredLoadComponent","react","requireDeferredForDisplay"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useCallback,k=c("deferredLoadComponent")(c("requireDeferredForDisplay")("MWCMSubthreadThreadViewChatTab.react").__setRef("MWCMSubThreadChatTabWithSubthread.react"));function l(a,b){return j(function(d){a(function(a){var e=a.onReturn;return i.jsx(c("CometPlaceholder.react"),{fallback:i.jsx(c("MWV2ChatTabLoadingWithGlimmers.react"),{tab:b}),children:i.jsx(k,{onReturn:function(){e()},tab:b,threadKey:d})})})},[a,b])}function m(a){var b=a.children,c=a.pushPage;a=a.tab;c=l(c,a);return i.jsx(d("MWCMSubthreadChatTabContext.react").MWCMSubthreadChatTabContextProvider,{pushSubthreadViewPage:c,children:b})}m.displayName=m.name+" [from "+f.id+"]";function a(a){var b=a.children,d=a.tab,e=a.thread,f=e.threadKey;return i.jsx("div",{className:"xgqcy7u x1lq5wgf x2c8kfy x17adc0v xhvchuf x1jx94hy x1rgmuzj xbbk1sx",children:i.jsx(c("BaseMultiStepContainer.react"),{disableFocusContainment:!1,disableInitialAutoFocus:!1,fallback:i.jsx(c("MWV2ChatTabLoadingWithGlimmers.react"),{tab:d}),fitContentWidth:!0,children:function(a){return i.jsx(m,{pushPage:a,tab:d,children:i.jsxs(c("MWV2TabContainer"),{style:{boxShadow:"none",margin:0},tab:d,threadKey:e.threadKey,children:[i.jsx(c("MWRelayChatTabHeaderRoot.react"),{pushPage:a,tab:d,threadKey:f}),b]})})}})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatTabInThreadBanner.react",["CometErrorBoundary.react","CometPlaceholder.react","LSMessagingThreadTypeUtil","MWLSInThreadBannerComponent.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){a=a.thread;if(d("LSMessagingThreadTypeUtil").isArmadilloSecure(a.threadType)||d("LSMessagingThreadTypeUtil").isJoinedSocialChannel(a.threadType))return null;else return i.jsx(c("CometPlaceholder.react"),{fallback:null,children:i.jsx(c("CometErrorBoundary.react"),{fallback:function(){return null},children:i.jsx(c("MWLSInThreadBannerComponent.react"),{threadKey:a.threadKey})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWPThreadPreview.react",["CometHeroInteractionWithDiv.react","I64","Int64Hooks","InteractionTracingMetrics","LSAuthorityLevel","LSContactBlockedByViewerStatus","LSContactGender","LSContactIdType","LSContactType","LSContactViewerRelationship","LSContactWorkForeignEntityType","LSFactory","LSIntEnum","LSLocalCreateOptimisticGroupThreadStoredProcedure","LSMessagingThreadTypeUtil","LSVec","LSVerifyContactRowExistsStoredProcedure","LSVerifyThreadRowExistsStoredProcedure","MWChatInteraction","MWPActor.react","MWPThreadThemeProvider.react","MWThreadKey.react","MWXSpinner.react","Promise","ReQL","ReQLSuspense","cr:9777","gkx","promiseDone","react","recoverableViolation","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m=l||(l=d("react"));e=l;var n=e.useEffect,o=e.useMemo,p={preview:{display:"x78zum5",flexDirection:"xdt5ytf",flexGrow:"x1iyjqo2",minHeight:"x2lwn1j",$$css:!0}};function q(a){var e=(k||(k=c("useReStore")))();n(function(){c("promiseDone")(e.runInTransaction(function(e){return(h||(h=b("Promise"))).all(a.map(function(a){return c("LSVerifyContactRowExistsStoredProcedure")(c("LSFactory")(e),{authorityLevel:(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").CLIENT_PARTIAL),blockedByViewerStatus:i.ofNumber(c("LSContactBlockedByViewerStatus").UNBLOCKED),contactIdType:i.ofNumber(c("LSContactIdType").FBID),contactType:i.ofNumber(c("LSContactType").USER),contactViewerRelationship:i.ofNumber(c("LSContactViewerRelationship").UNKNOWN),gender:i.ofNumber(c("LSContactGender").UNKNOWN),id:a.id,isBlocked:!1,isMemorialized:!1,isSelf:!1,workForeignEntityType:i.ofNumber(c("LSContactWorkForeignEntityType").UNKNOWN)})}))},"readwrite",void 0,void 0,f.id+":90"))},[e,JSON.stringify(a.map(function(a){return(j||(j=d("I64"))).to_string(a.id)}))])}function r(a){var b=a.children,e=a.renderThreadPreview,f=a.renderThreadView,g=a.thread,h=d("MWChatInteraction").get("open_with_tokens");n(function(){h!=null&&(c("InteractionTracingMetrics").addAnnotation(h,"thread_id",(j||(j=d("I64"))).to_string(g.threadKey)),c("InteractionTracingMetrics").addAnnotation(h,"thread_type",j.to_string(g.threadType)),c("InteractionTracingMetrics").addAnnotationBoolean(h,"is_secure",d("LSMessagingThreadTypeUtil").isArmadilloSecure(g.threadType)))},[h,g.threadKey,g.threadType]);return e!=null?e(g,b):m.jsx(d("MWThreadKey.react").MWThreadKeyProvider,{id:g.threadKey,children:m.jsxs("div",{className:"x78zum5 xdt5ytf x1iyjqo2 x6prxxf x2lwn1j",children:[m.jsx(c("CometHeroInteractionWithDiv.react"),{interactionDesc:"MWV2_CHAT_TAB",interactionUUID:h,pageletName:"ChatTab",xstyle:p.preview,children:m.jsx(c("MWPThreadThemeProvider.react"),{themeFbid:g.themeFbid,children:f(g)})}),m.jsx("div",{className:"x2lah0s x879a55",children:b})]})})}r.displayName=r.name+" [from "+f.id+"]";function s(a){var b=a.children,e=a.recipientToken,g=a.renderThreadPreview,h=a.renderThreadView,j=a.setPreviewThread,l=(k||(k=c("useReStore")))(),o=e.threadType,p=e.id;q([e]);d("Int64Hooks").useEffectInt64(function(){c("promiseDone")(l.runInTransaction(function(a){return c("LSVerifyThreadRowExistsStoredProcedure")(c("LSFactory")(a),{syncGroup:(i||(i=d("LSIntEnum"))).ofNumber(1),threadKey:p,threadType:o})},"readwrite",void 0,void 0,f.id+":187"))},[l,p,o]);var s=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(l.tables.threads).getKeyRange(p)},[l,p],f.id+":198");n(function(){j(s)},[j,s]);if(s!=null)return m.jsx(r,{renderThreadPreview:g,renderThreadView:h,thread:s,children:b});else return null}s.displayName=s.name+" [from "+f.id+"]";function t(a,b,e){var g=(k||(k=c("useReStore")))(),h=(j||(j=d("I64"))).to_string(d("MWPActor.react").useActor()),i=d("ReQLSuspense").useArray(function(){return d("ReQL").fromTableAscending(g.tables.participants).filter(function(a){return b.has((j||(j=d("I64"))).to_string(a.contactId))}).map(function(a){return(j||(j=d("I64"))).to_string(a.threadKey)})},[g,b],f.id+":234");return d("ReQLSuspense").useFirst(function(){var c=new Set(i);return d("ReQL").fromTableAscending(g.tables.threads).filter(function(a){return(j||(j=d("I64"))).equal(a.threadType,e)}).filter(function(a){return a.threadName==null}).filter(function(a){a=a.clientThreadKey;if(a!=null)return c.has((j||(j=d("I64"))).to_string(a));else return!1}).filter(function(a){a=a.clientThreadKey;return a==null?!1:!0}).map(function(a){var b=a.clientThreadKey;b=d("ReQLSuspense").toArray(d("ReQL").fromTableDescending(g.tables.participants.index("threadKeyReadWatermarkTimestampMs")).getKeyRange(b).map(function(a){return(j||(j=d("I64"))).to_string(a.contactId)}).filter(function(a){return a!==h}),f.id+":274");return{participantsWithoutActor:b,thread:a}}).filter(function(c){c=c.participantsWithoutActor;if(a.length===1&&c.length===0)return!0;else if(c.every(function(a){return b.has(a)}))return c.length===b.size;else return!1}).map(function(a){return a.thread})},[i,g,e,a.length,h,b],f.id+":247")}function u(a,e,g,l,m,n){m===void 0&&(m=null);n===void 0&&(n=null);var o=(k||(k=c("useReStore")))(),p=a==null;d("Int64Hooks").useEffectInt64(function(){p&&c("promiseDone")(o.runInTransaction(function(a){if((j||(j=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(2))){var f;return c("LSLocalCreateOptimisticGroupThreadStoredProcedure")(c("LSFactory")(a),{checkExistingThreads:l,participants:c("LSVec").ofArray(g.map(function(a){return a.id})),threadMetadata:(f=m)!=null?f:void 0,threadName:(f=n)!=null?f:void 0}).then(function(){})}else if(d("LSMessagingThreadTypeUtil").isArmadilloSecure(e))return b("cr:9777")==null?(h||(h=b("Promise"))).resolve():b("cr:9777").call(a,g,e);c("recoverableViolation")("Don't know how to create optimistic thread for thread of thread type "+(e!=null?(j||(j=d("I64"))).to_string(e):""),"messenger_web_creation");return(h||(h=b("Promise"))).resolve()},"readwrite",void 0,void 0,f.id+":330"))},[l,o,p,g,m,e,n])}function v(a){var b=a.checkExistingThreads,c=a.children,d=a.renderThreadPreview,e=a.renderThreadView,f=a.setPreviewThread,g=a.threadMetadata;g=g===void 0?null:g;var h=a.threadName;h=h===void 0?null:h;var i=a.threadType,j=a.tokenContactIdsMaybeExcludingActor,k=a.tokens;a=a.tokensMaybeExcludingActor;var l=t(a,j,i);q(a);u(l,i,k,b,g,h);n(function(){f(l)});if(l!=null)return m.jsx(r,{renderThreadPreview:d,renderThreadView:e,thread:l,children:c});else return null}v.displayName=v.name+" [from "+f.id+"]";function w(a,b,e,g,h){var l=(k||(k=c("useReStore")))(),m=(j||(j=d("I64"))).to_string(d("MWPActor.react").useActor()),n=d("ReQLSuspense").useArray(function(){return d("ReQL").fromTableAscending(l.tables.participants).filter(function(a){return b.has((j||(j=d("I64"))).to_string(a.contactId))}).map(function(a){return(j||(j=d("I64"))).to_string(a.threadKey)})},[l,b],f.id+":436"),o=c("gkx")("24167")||c("gkx")("33038");return d("ReQLSuspense").useFirst(function(){var k=new Set(n),p=a.length>1;p=p&&c("gkx")("5703");p=p?d("ReQL").fromTableDescending(l.tables.threads.index("lastActivityTimestampMs")):d("ReQL").fromTableAscending(l.tables.threads).filter(function(a){return(j||(j=d("I64"))).equal(a.threadType,e)});return p.filter(function(a){return o&&h!=null?a.threadName===h:a.threadName==null}).filter(function(a){if(g)return!0;else return(j||(j=d("I64"))).equal(a.authorityLevel,(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC))}).filter(function(a){return k.has((j||(j=d("I64"))).to_string(a.threadKey))}).map(function(a){var b=d("ReQLSuspense").toArray(d("ReQL").fromTableDescending(l.tables.participants.index("threadKeyReadWatermarkTimestampMs")).getKeyRange(a.threadKey).map(function(a){return(j||(j=d("I64"))).to_string(a.contactId)}),f.id+":489");return{participantsWithActor:b,thread:a}}).filter(function(a){a=a.participantsWithActor;var c=a.filter(function(a){return a!==m});if(c.length===0&&a.length===1)return!0;else if(a.length===c.length||c.length!==b.size)return!1;else return c.every(function(a){return b.has(a)})}).map(function(a){return a.thread})},[n,l,JSON.stringify(e),g,a,b,m,h,o],f.id+":452")}function x(a){var b=a.checkExistingThreads,c=a.children,e=a.renderThreadPreview,f=a.renderThreadView,g=a.setPreviewThread,h=a.threadMetadata;h=h===void 0?null:h;var i=a.threadName;i=i===void 0?null:i;var k=a.threadType,l=a.tokens,p=a.tokensMaybeExcludingActor;a=o(function(){return new Set(p.map(function(a){return(j||(j=d("I64"))).to_string(a.id)}))},[p]);var q=w(p,a,k,b,i);n(function(){q!=null&&g(q)},[g,q]);if(q!=null)return m.jsx(r,{renderThreadPreview:e,renderThreadView:f,thread:q,children:c});else return m.jsx(v,{checkExistingThreads:b,renderThreadPreview:e,renderThreadView:f,setPreviewThread:g,threadMetadata:h,threadName:i,threadType:k,tokenContactIdsMaybeExcludingActor:a,tokens:l,tokensMaybeExcludingActor:p,children:c})}x.displayName=x.name+" [from "+f.id+"]";function a(a){var b=a.areWeCreatingASecureThread,e=a.checkExistingThreads;e=e===void 0?!0:e;var f=a.children,g=a.isCutoverInProgress;g=g===void 0?!1:g;var h=a.nullstate;h=h===void 0?null:h;var k=a.renderThreadPreview,l=a.renderThreadView,p=a.setPreviewThread,q=a.threadMetadata;q=q===void 0?null:q;var r=a.threadName;r=r===void 0?null:r;var t=a.tokens,u=d("MWPActor.react").useActor();a=o(function(){return t.filter(function(a){return!(j||(j=d("I64"))).equal(a.id,u)})},[t,u]);n(function(){t.length===0&&p()},[p,t]);if(g)return m.jsx("div",{className:"x6s0dn4 x78zum5 x1iyjqo2 xl56j7k",children:m.jsx(c("MWXSpinner.react"),{color:"disabled",size:24})});if(t.length===0)return h;g=a.length;if(g!==1){if(g===0)return b?m.jsx(x,{checkExistingThreads:e,renderThreadPreview:k,renderThreadView:l,setPreviewThread:p,threadMetadata:q,threadType:(i||(i=d("LSIntEnum"))).ofNumber(15),tokens:t,tokensMaybeExcludingActor:t,children:f}):m.jsx(s,{recipientToken:t[0],renderThreadPreview:k,renderThreadView:l,setPreviewThread:p,children:f})}else{h=a[0];if(e)if(b)return m.jsx(x,{checkExistingThreads:e,renderThreadPreview:k,renderThreadView:l,setPreviewThread:p,threadMetadata:q,threadType:(i||(i=d("LSIntEnum"))).ofNumber(15),tokens:t,tokensMaybeExcludingActor:a,children:f});else return m.jsx(s,{recipientToken:h,renderThreadPreview:k,renderThreadView:l,setPreviewThread:p,children:f})}return m.jsx(x,{checkExistingThreads:e,renderThreadPreview:k,renderThreadView:l,setPreviewThread:p,threadMetadata:q,threadName:r,threadType:b?(i||(i=d("LSIntEnum"))).ofNumber(16):(i||(i=d("LSIntEnum"))).ofNumber(2),tokens:t,tokensMaybeExcludingActor:a,children:f})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("useMWChatStateUpdateThreadKeyDescriptorIfAuthoritative",["Int64Hooks","LSAuthorityLevel","LSIntEnum","MWChatStateActions","MWChatStateV2.react"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,e){e===void 0&&(e={shouldClearOldHiddenTab:!1,shouldUpdateThreadType:!1});var f=d("MWChatStateV2.react").useDispatch(),g=a==null?void 0:a.threadKey,i=a==null?void 0:a.clientThreadKey,j=a==null?void 0:a.threadType,k=a==null?void 0:a.authorityLevel;d("Int64Hooks").useEffectInt64(function(){g!=null&&k!=null&&(h||(h=d("LSIntEnum"))).toNumber(k)>=c("LSAuthorityLevel").AUTHORITATIVE&&f(d("MWChatStateActions").updateThreadKeyDescriptor(b.tabId,g,i,e.shouldUpdateThreadType?j:void 0,{shouldClearOldHiddenTab:e.shouldClearOldHiddenTab}))},[b.tabId,g,i,f,k,j,e.shouldUpdateThreadType,e.shouldClearOldHiddenTab])}g["default"]=a}),98);
__d("MWDefaultE2eeThreadPreview.react",["CometPlaceholder.react","CometProgressRingIndeterminate.react","I64","LSIntEnum","LSSearchType","LSThreadAttributionStore","MWComposerGating.react","MWOpenAndSecureThreadView.react","MWPThreadPreview.react","MWPThreadThemeProvider.react","MWRelayChatTabHeaderRoot.react","MWV2TabContainer","ReQL","ReQLSuspense","react","useMWChatStateUpdateThreadKeyDescriptorIfAuthoritative","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=k||(k=d("react"));b=k;var m=b.useEffect,n=b.useMemo,o=b.useState;function a(a){var b,e,g=a.otherContactIdForDefaultE2eeThread;a=a.tab;var k=(h||(h=c("useReStore")))(),p=d("ReQLSuspense").useFirst(function(){return g==null?d("ReQL").empty():d("ReQL").fromTableAscending(k.tables.contacts,["blockedByViewerStatus","name","profilePictureUrl","id"]).getKeyRange(g)},[k,g],f.id+":53"),q=o(),r=q[0];q=q[1];c("useMWChatStateUpdateThreadKeyDescriptorIfAuthoritative")(r,a,{shouldClearOldHiddenTab:!1,shouldUpdateThreadType:!1});var s=r==null?void 0:r.threadKey;m(function(){if(s==null||g==null)return;var a=d("LSThreadAttributionStore").getSource(void 0,(i||(i=d("I64"))).to_string(g));a.value!=="unknown"&&(a.type==="LSThreadAttribution"?d("LSThreadAttributionStore").setLSMessagingThreadAttribution((i||(i=d("I64"))).to_string(s),i.to_string(a.value)):d("LSThreadAttributionStore").setSource((i||(i=d("I64"))).to_string(s),a.value))},[s,g]);var t=l.jsx("div",{className:"x6s0dn4 x78zum5 x1iyjqo2 xl56j7k",children:l.jsx(c("CometProgressRingIndeterminate.react"),{color:"disabled",size:24})});b=r!=null&&l.jsx(c("CometPlaceholder.react"),{fallback:null,children:l.jsx(c("MWPThreadThemeProvider.react"),{themeFbid:r.themeFbid,children:l.jsx(d("MWComposerGating.react").MWChatComposerGating,{isPreviewThread:!0,thread:r},(i||(i=d("I64"))).to_string((b=r.clientThreadKey)!=null?b:r.threadKey))})});var u=n(function(){return p!=null?[{blockedByViewerStatus:p.blockedByViewerStatus,contextLine:"",displayName:p.name,id:p.id,profilePicUrl:p.profilePictureUrl,threadType:(j||(j=d("LSIntEnum"))).ofNumber(15),type_:(j||(j=d("LSIntEnum"))).ofNumber(c("LSSearchType").CONTACT)}]:[]},[p]);return l.jsxs(c("MWV2TabContainer"),{tab:a,threadKey:(e=r==null?void 0:r.threadKey)!=null?e:void 0,children:[r&&l.jsx(c("MWRelayChatTabHeaderRoot.react"),{tab:a,threadKey:r.threadKey}),l.jsx(c("CometPlaceholder.react"),{fallback:null,children:l.jsx(c("MWPThreadPreview.react"),{areWeCreatingASecureThread:!0,nullstate:t,renderThreadView:function(a){return l.jsx(c("MWOpenAndSecureThreadView.react"),{thread:a})},setPreviewThread:q,tokens:u,children:b})})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWInChatTabContextProvider.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));c=h;e=c.createContext;var j=c.useContext,k=e(!1);function a(){return j(k)}function b(a){a=a.children;return i.jsx(k.Provider,{value:!0,children:a})}b.displayName=b.name+" [from "+f.id+"]";g.useInChatTab=a;g.InChatTabContextProvider=b}),98);
__d("useMWFetchMessageByPinnedMessageId",["FBLogger","I64","LSFactory","LSMessagePointQueryStoredProcedure","LSMessagingThreadTypeUtil","MAWThreadCutover","ReQL","ReQLSuspense","asyncToGeneratorRuntime","promiseDone","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var g;g=(i||(i=d("I64"))).to_int32((g=b.syncGroup)!=null?g:(i||(i=d("I64"))).neg_one);if(g!==-1&&g===95){c("FBLogger")("messenger_web_messaging").mustfix("useMWFetchMessageByPinnedMessageId: incorrect call to MPQ with secure mailbox");return}yield a.runInTransaction(function(a){return c("LSMessagePointQueryStoredProcedure")(c("LSFactory")(a),{messageId:e,threadKey:b.threadKey,threadType:b.threadType})},"readwrite",void 0,void 0,f.id+":53")});return k.apply(this,arguments)}function a(a){var b=(h||(h=c("useReStore")))(),e=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(b.tables.threads,["threadType"]).getKeyRange(a)},[b,a],f.id+":66"),g=d("MAWThreadCutover").useGetCutoverOpenThreadKey(a),i=g!=null,k=g||a;g=d("MAWThreadCutover").useIsDualThreadCutoverOpenThread(g);e=e!=null&&d("LSMessagingThreadTypeUtil").isArmadilloSecure(e.threadType);var l=e&&(!i||g),m=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableDescending(b.tables.threads,["threadKey","threadType","syncGroup"]).getKeyRange(k)},[b,k],f.id+":86");e=d("ReQLSuspense").useArray(function(){return l?d("ReQL").empty():d("ReQL").fromTableDescending(b.tables.msg_pinned_messages_v2.index("pinnedMessageDisplayOrder")).getKeyRange(k).map(function(a){a=a.messageId;var e=d("ReQLSuspense").first(d("ReQL").fromTableDescending(b.tables.messages.index("messageId")).getKeyRange(a),f.id+":105");m!=null&&e==null&&c("promiseDone")(j(b,m,a));return{message:e,pinnedMessageId:a}})},[b,k,l,m],f.id+":96");return e.map(function(a){return a.message})}g["default"]=a}),98);
__d("useMWJumpToMessageWrapper",["useMWJumpToMessage"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return c("useMWJumpToMessage")(a.source)}g["default"]=a}),98);
__d("MWInboxPinnedMessagesBanner.react",["fbt","BaseMiddot.react","CometErrorBoundary.react","FBLogger","I64","JSResourceForInteraction","LSIntEnum","LSMessagingThreadTypeUtil","MWBroadcastChannelLoggingShapes","MWLSThreadDisplayContext","MWLogBroadcastChannelFalcoEvent","MWPActor.react","MWUnvaultedText","MWXColumn.react","MWXColumnItem.react","MWXIconChevronDown","MWXIconForListCell.react","MWXIconPushpin","MWXIconStrict.react","MWXPressable.react","MWXRow.react","MWXRowItem.react","MWXText.react","ReQL","ReQLSuspense","cr:7535","isMWBumpMessage","react","useMWFetchMessageByPinnedMessageId","useMWJumpToMessageWrapper","useMWXLazyDialog","useReStore","useStringWithSubstitutions"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=j||(j=d("react")),n=j.useMemo;function a(a){return[]}var o=(b=b("cr:7535"))!=null?b:a,p={pinnedMessagesWrapper:{alignItems:"x6s0dn4",display:"x78zum5",$$css:!0},pinnedMessagesWrapperChatTabs:{borderBottomColor:"x80vd3b",borderBottomStyle:"x1q0q8m5",borderBottomWidth:"xso031l",$$css:!0},pinnedMessagesWrapperInbox:{borderTopColor:"x1pdss0j",borderTopStyle:"x13fuv20",borderTopWidth:"x178xt8z",$$css:!0},row:{height:"x10wjd1d",marginTop:"xdj266r",marginEnd:"x11i5rnm",marginBottom:"xat24cr",marginStart:"x1mh8g0r",$$css:!0},rowText:{height:"xlup9mm",$$css:!0}},q=c("JSResourceForInteraction")("MWPinnedMessagesDialog.react").__setRef("MWInboxPinnedMessagesBanner.react");function r(a,b,e){var f=a==null?void 0:a.text,g=b&&a!=null?(k||(k=d("I64"))).equal(e,a.threadKey):!1;b=n(function(){var b;return new Set(g?(b=a==null?void 0:(b=a.mentionIds)==null?void 0:b.split==null?void 0:b.split(","))!=null?b:[]:[])},[g,a==null?void 0:a.mentionIds]);f=d("MWUnvaultedText").getMWUnvaultedText(g,f);b=(b=(b=d("useStringWithSubstitutions").useStringWithMentionSubstitutionsAndUpdatedRanges(f,[],b))==null?void 0:b.textWithSubstitutions)!=null?b:f;e=(e=d("useStringWithSubstitutions").useStringWithSubstitutions(f,e))!=null?e:f;f=c("isMWBumpMessage")(a);return f?e:b}function s(a){if(a==null)return"";if((k||(k=d("I64"))).equal(a.displayedContentTypes,(l||(l=d("LSIntEnum"))).ofNumber(2)))return h._("__JHASH__xgjHlv2kQPY__JHASH__");else if((k||(k=d("I64"))).equal(a.displayedContentTypes,(l||(l=d("LSIntEnum"))).ofNumber(4)))return h._("__JHASH__X9DncealQbJ__JHASH__");else if((k||(k=d("I64"))).equal(a.displayedContentTypes,(l||(l=d("LSIntEnum"))).ofNumber(4096))||(k||(k=d("I64"))).equal(a.displayedContentTypes,(l||(l=d("LSIntEnum"))).ofNumber(134217728)))return h._("__JHASH__rZqTMZ7dJmB__JHASH__");else if((k||(k=d("I64"))).equal(a.displayedContentTypes,(l||(l=d("LSIntEnum"))).ofNumber(16384)))return h._("__JHASH__qqvxkP_nlPB__JHASH__");else if((k||(k=d("I64"))).equal(a.displayedContentTypes,(l||(l=d("LSIntEnum"))).ofNumber(64)))return h._("__JHASH__BbHS9IlclMk__JHASH__");return h._("__JHASH__KsTQ68TZNpQ__JHASH__")}function t(a){c("FBLogger")("messenger_web_pinned_messages").catching(a).mustfix("uncaught exception in MWInboxPinnedMessagesBanner.react. Error:%s",a.message)}function e(a){a=a.thread;return m.jsx(c("CometErrorBoundary.react"),{fallback:function(){return null},onError:t,children:m.jsx(u,{thread:a})})}e.displayName=e.name+" [from "+f.id+"]";function u(a){var b=a.thread;a=c("useMWXLazyDialog")(q);var e=a[0],g=(i||(i=c("useReStore")))();a=c("useMWFetchMessageByPinnedMessageId")(b.threadKey);var j=o(b.threadKey);j=j.concat(a);a=[];var l=j.reduce(function(a,b){return b!=null?[].concat(a,[b]):a},a);j=d("MWPActor.react").useActor();var t=c("useMWJumpToMessageWrapper")({source:"Pinned"}),u=(l==null?void 0:l.length)>0?l[0]:null;a=d("ReQLSuspense").useFirst(function(){return(u==null?void 0:u.senderId)!=null?d("ReQL").fromTableAscending(g.tables.contacts).getKeyRange(u.senderId):d("ReQL").empty()},[u==null?void 0:u.senderId,g],f.id+":245");var v=d("LSMessagingThreadTypeUtil").isArmadilloSecure(b.threadType),w=r(u,v,b.threadKey);v=n(function(){return w!=null&&w!==""?w:s(u)},[u,w]);var x=d("MWLSThreadDisplayContext").useMWLSThreadDisplayContext()==="Inbox";if(l.length===0)return null;var y={eventName:"open_view_pinned_messages_dialog",threadKey:b.threadKey,threadType:b.threadType},z=d("LSMessagingThreadTypeUtil").isDiscoverablePublicBroadcastChannel(b.threadType);a=(u==null?void 0:u.senderId)!=null&&(k||(k=d("I64"))).equal(j,u.senderId)?"You":(j=a==null?void 0:a.name)!=null?j:"";return m.jsx(c("MWXPressable.react"),{"aria-label":z?h._("__JHASH__uKLUxuQU_CD__JHASH__",[h._param("lastPinnedMessage",v)]):h._("__JHASH__YIRbXxGdt3C__JHASH__",[h._param("lastPinnedMessage",v)]),display:"inline",expanding:!0,loggingEvent:y,onPress:function(){if(l.length===1){var a=l[0];a!=null&&a.messageId!=null&&a.timestampMs!=null&&t(a.messageId,a.timestampMs)}else e({threadKey:b.threadKey});z&&d("MWLogBroadcastChannelFalcoEvent").logBroadcastChannelFalcoEvent(babelHelpers["extends"]({},d("MWBroadcastChannelLoggingShapes").VIEW_PINNED_MESSAGES_FROM_THREAD_VIEW_BANNER,{clientExtras:{isDialogOpened:(l.length>1).toString()},threadFbid:b.threadKey}))},overlayDisabled:!0,overlayFocusRingPosition:"inset",testid:void 0,xstyle:[p.pinnedMessagesWrapper,x?p.pinnedMessagesWrapperInbox:p.pinnedMessagesWrapperChatTabs],children:m.jsxs(c("MWXRow.react"),{expanding:!0,paddingHorizontal:8,paddingVertical:0,verticalAlign:"center",xstyle:p.row,children:[m.jsx(c("MWXRowItem.react"),{verticalAlign:"center",children:m.jsx(c("MWXIconForListCell.react"),{color:"secondary",icon:c("MWXIconPushpin"),size:"medium"})}),m.jsx(c("MWXRowItem.react"),{expanding:!0,verticalAlign:"center",children:m.jsxs(c("MWXColumn.react"),{children:[m.jsx(c("MWXColumnItem.react"),{verticalAlign:"center",xstyle:p.rowText,children:m.jsx(c("MWXText.react"),{color:"secondary",numberOfLines:1,type:"meta3",children:z?h._("__JHASH__Dezv4EV21yi__JHASH__",[h._param("channel_creator_name",a),h._param("middot",m.jsx(c("BaseMiddot.react"),{}))]):h._("__JHASH__5htmo3zfvNj__JHASH__",[h._param("message_sender_name",a)])})}),m.jsx(c("MWXColumnItem.react"),{verticalAlign:"center",xstyle:p.rowText,children:m.jsx(c("MWXText.react"),{numberOfLines:1,type:"bodyLink4",children:v})})]})}),l.length>1&&m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("MWXIconStrict.react"),{color:"secondary",icon:c("MWXIconChevronDown"),size:16})})]})})}u.displayName=u.name+" [from "+f.id+"]";g["default"]=e}),226);
__d("MWV2ChatTabThreadLinkHashContext.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));c=h;e=c.createContext;var j=c.useContext,k=e(null);function a(a){var b=a.children;a=a.threadLinkHash;return i.jsx(k.Provider,{value:(a=a)!=null?a:null,children:b})}a.displayName=a.name+" [from "+f.id+"]";function b(){return j(k)}g.MWV2ChatTabThreadLinkHashContextProvider=a;g.useGetChatTabThreadLinkHash=b}),98);
__d("useMWCloseDuplicateChatTabs",["I64","MWChatStateActions","MWChatStateContext","MWChatStateV2.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(h||d("react")).useEffect;function a(a){var b=d("MWChatStateContext").useChatState(function(a){return a.tabs}),c=d("MWChatStateV2.react").useDispatch();j(function(){var e;if(((e=a.tabType.threadKeyDescriptor)==null?void 0:e.threadKey)==null)return;e=Array.from(b.values()).filter(function(b){var c,e=b.tabId;b=b.tabType;return((c=b.threadKeyDescriptor)==null?void 0:c.threadKey)==null||((c=a.tabType.threadKeyDescriptor)==null?void 0:c.threadKey)==null?!1:a.tabId>e&&(i||(i=d("I64"))).equal(b.threadKeyDescriptor.threadKey,a.tabType.threadKeyDescriptor.threadKey)});e.forEach(function(a){var b=a.closeWatermark,e=a.openWatermark;a=a.tabId;e>b&&c(d("MWChatStateActions").closeTab(Date.now(),a))})},[c,a,b])}g["default"]=a}),98);
__d("MWV2ChatTab.react",["CometErrorBoundary.react","CometMessagingChatTabErrorState.react","CometPageletWithDiv.react","CometTransientDialogProvider.react","I64","Int64Hooks","InteractionTracingMetrics","LSAuthorityLevel","LSFactory","LSIntEnum","LSMessagingThreadTypeUtil","LSPlatformWaitForTaskCompletion","LSThreadBitOffset","LSThreadPointQueryAndRestoreMessagesWithJIDStoredProcedure","LegacyHidden","MAWInThreadBannerNuxReqCondWrapper.react","MAWThreadCutover","MAWUnrecoverableErrorBoundary.react","MWChatConnectionStatusCard.react","MWChatInteraction","MWChatStateContext","MWChatTabInThreadBanner.react","MWInChatTabContextProvider.react","MWInboxPinnedMessagesBanner.react","MWOpenAndSecureThreadView.react","MWPNewMessageAnnouncementForScreenReaders.react","MWPThreadIsPage.react","MWPThreadThemeProvider.react","MWPVisibleMessageContext.react","MWRelayChatTabHeaderRoot.react","MWThreadKey.react","MWV2ChatTabHeaderLoadingWithGlimmers.react","MWV2ChatTabLoadingWithGlimmers.react","MWV2ChatTabThreadLinkHashContext.react","MWV2ComposerActionsContext.react","MWV2ComposerHasContentContext.react","MWV2EnsureThatChatTabExists","MWV2ErrorComposer.react","MWV2FileDropzone.react","MWV2TabContainer","MWXRelayComposer.react","MetaConfig","ReQL","ReQLSuspense","XPlatWebAudioPlaybackContextProvider.react","cr:1113","cr:5001","cr:6111","cr:8060","cr:8061","emptyFunction","gkx","promiseDone","react","stylex","useC4gEngagementImpressionLogging","useEmptyFunction","useMAWTriggerOnDemandCutover","useMWChatStateUpdateThreadKeyDescriptorIfAuthoritative","useMWCloseDuplicateChatTabs","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m=j||(j=d("react")),n=j,o=n.memo,p=n.useCallback,q=n.useLayoutEffect,r=n.useMemo,s=n.useRef;function a(a,b){return[!1,!0,null]}var t=(n=b("cr:8061"))!=null?n:a,u=(n=b("cr:1113"))!=null?n:c("useEmptyFunction");function v(a){var b=a.children;a=a.themeFbid;return c("gkx")("24125")?m.jsx(c("CometTransientDialogProvider.react"),{children:m.jsx(c("MWPThreadThemeProvider.react"),{themeFbid:a,children:b})}):m.jsx(c("MWPThreadThemeProvider.react"),{themeFbid:a,children:m.jsx(c("CometTransientDialogProvider.react"),{children:b})})}v.displayName=v.name+" [from "+f.id+"]";function w(a){var e=a.isMinimized,f=a.otherContactIdForDefaultE2eeThread,g=a.shouldUseDefaultE2eeOneToOne,h=a.tab,i=a.thread;a=a.threadLinkHash;var j=i.themeFbid,k=i.threadKey,l=i.threadSubtype,n=i.threadType;u({groupThreadSubtype:l,threadKey:k,threadType:n});c("useC4gEngagementImpressionLogging")({threadKey:k,threadType:n});l=d("LSMessagingThreadTypeUtil").isDiscoverablePublicBroadcastChannel(n);var o=d("LSThreadBitOffset").has(167,i),t=!d("LSThreadBitOffset").has(56,i);n=d("LSMessagingThreadTypeUtil").isArmadilloSecure(n);var w=s({getScrollAreaElement:c("emptyFunction"),jumpToMostRecentMessage:c("emptyFunction"),restoreScrollPosition:c("emptyFunction")}),x=d("MWChatStateContext").useChatState(function(a){return a.focusedTabId});c("useMWCloseDuplicateChatTabs")(h);q(function(){if(x!==h.tabId){var a;(a=w.current)==null?void 0:a.restoreScrollPosition()}},[x,h.tabId]);l=d("LSThreadBitOffset").has(106,i)&&l&&c("MetaConfig")._("105");var y=c("gkx")("4889"),z=p(function(){var a;(a=w.current)==null?void 0:a.jumpToMostRecentMessage()},[]),A=r(function(){return y===!0?c("emptyFunction"):z},[y,z]),B=r(function(){return y===!0?z:c("emptyFunction")},[y,z]);n=m.jsxs(m.Fragment,{children:[h.tabId!==x?null:m.jsx(c("MWPNewMessageAnnouncementForScreenReaders.react"),{thread:i}),n?m.jsx(c("MAWInThreadBannerNuxReqCondWrapper.react"),{}):null,m.jsx(c("MWChatConnectionStatusCard.react"),{}),m.jsx(c("MWChatTabInThreadBanner.react"),{thread:i}),l&&m.jsx(c("MWInboxPinnedMessagesBanner.react"),{thread:i}),m.jsxs(d("MWV2FileDropzone.react").MWV2FileDropzone,{isMediaOnly:t,thread:i,children:[m.jsx(c("MWOpenAndSecureThreadView.react"),{entryPoint:"popup_chat_box",isMinimizedChatTab:e,messageListRef:w,thread:i}),m.jsx(c("MAWUnrecoverableErrorBoundary.react"),{fallback:function(a){return m.jsx(c("CometMessagingChatTabErrorState.react"),{error:a})},children:m.jsx(c("CometErrorBoundary.react"),{fallback:function(){return m.jsx(c("MWV2ErrorComposer.react"),{})},children:m.jsx(d("MWV2ChatTabThreadLinkHashContext.react").MWV2ChatTabThreadLinkHashContextProvider,{threadLinkHash:a,children:m.jsx(d("MWV2ComposerActionsContext.react").MWV2ComposerActionsListener,{onMessageSendAttempt:B,children:m.jsx(d("CometPageletWithDiv.react").Placeholder,{fallback:null,name:"MWComposer",children:m.jsx(c("MWXRelayComposer.react"),{afterSendMessage:A,isPreviewThread:!1,threadKey:k})})})})})})]})]});l=b("cr:6111")!=null&&o?m.jsx(b("cr:6111"),{tab:h,thread:i,children:n}):null;t=function(a){return g?m.jsx(m.Fragment,{children:a}):m.jsx(d("MWThreadKey.react").MWThreadKeyProvider,{id:k,children:a})};e=b("cr:5001")==null?void 0:b("cr:5001").MWAdmodOnboardingSuggestedActionsContextProvider;a=l!=null?l:g&&b("cr:8060")!=null?m.jsx(b("cr:8060"),{otherContactIdForDefaultE2eeThread:f,tab:h}):m.jsxs(c("MWV2TabContainer"),{tab:h,threadKey:k,children:[m.jsx(d("CometPageletWithDiv.react").Placeholder,{fallback:m.jsx(c("MWV2ChatTabHeaderLoadingWithGlimmers.react"),{tab:h}),name:"MWChatTabHeader",children:m.jsx(c("MWRelayChatTabHeaderRoot.react"),{tab:h,threadKey:k})}),n]});return m.jsx(d("MWPThreadIsPage.react").Provider,{threadKey:k,children:t(m.jsx(c("XPlatWebAudioPlaybackContextProvider.react"),{children:m.jsx(d("MWPVisibleMessageContext.react").MWPVisibleMessageContextProvider,{children:m.jsx(v,{themeFbid:j,children:m.jsx(d("MWV2ComposerHasContentContext.react").MWV2ComposerHasContentContextProvider,{children:m.jsx(d("MWInChatTabContextProvider.react").InChatTabContextProvider,{children:e!=null?m.jsx(e,{children:a}):a})})})})}))})}w.displayName=w.name+" [from "+f.id+"]";function x(a,b){var e=d("MAWThreadCutover").useIsDualThreadCutoverOpenThread(a),g=(d("MAWThreadCutover").useIsCutoverOpenThread(a)||b!=null&&d("LSThreadBitOffset").has(128,b))&&!e&&c("gkx")("24126");b=d("MAWThreadCutover").useGetCutoverSecureThreadKey((l||(l=d("I64"))).to_string(a));var i=c("gkx")("24126")?b:null,j=(h||(h=c("useReStore")))();d("Int64Hooks").useEffectInt64(function(){if(!g)return;if(i==null)c("promiseDone")(c("LSPlatformWaitForTaskCompletion")(j,function(b){return c("LSThreadPointQueryAndRestoreMessagesWithJIDStoredProcedure")(c("LSFactory")(b),{waJid:a})},"readwrite"));else{var b=d("MWChatInteraction").get((l||(l=d("I64"))).to_string(a));if(b!=null){var e;d("MWChatInteraction").set(i,b);(e=c("InteractionTracingMetrics")).addMetadata(b,"thread_id",i);e.addMetadata(b,"thread_type",15..toString());e.addMetadata(b,"is_secure",!0);e.addMetadata(b,"redirectedFromPreCutover",1)}}},[i,j,g,a]);b=d("ReQLSuspense").useFirst(function(){return i!=null?d("ReQL").fromTableAscending(j.tables.threads).getKeyRange((l||(l=d("I64"))).of_string(i)):d("ReQL").empty()},[j,i],f.id+":403");e=e?void 0:b;return e}var y={hidden:{display:"x1s85apg",$$css:!0}};function e(a){var b,e=a.isMinimized;e=e===void 0?!1:e;var g=a.tab;a=a.threadKeyDescriptor;var j=(h||(h=c("useReStore")))(),n=a.threadKey,o=a.clientThreadKey,p=a.threadLinkHash;d("MWV2EnsureThatChatTabExists").useMWV2EnsureThatChatTabExists(n,a.threadType,o);var q=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(j.tables.threads,["folderName","themeFbid","threadKey","threadType","parentThreadKey","threadSubtype","threadName","authorityLevel","cannotUnsendReason","threadStatus","cannotReplyReason","clientThreadKey","consistentThreadFbid"].concat(d("LSThreadBitOffset").threadCapabilityFields)).getKeyRange(n)},[j,n],f.id+":442"),r=d("ReQLSuspense").useFirst(function(){return o!=null?d("ReQL").fromTableAscending(j.tables.threads.index("clientThreadKey")).getKeyRange(o):d("ReQL").empty()},[j,o],f.id+":461"),s=x(n,q);q=(s=(s=s)!=null?s:q)!=null?s:r;c("useMWChatStateUpdateThreadKeyDescriptorIfAuthoritative")(q,g,{shouldClearOldHiddenTab:!0,shouldUpdateThreadType:!0});r=t((s=q==null?void 0:q.threadKey)!=null?s:n,q==null?void 0:q.threadType);s=r[0];var u=r[1];r=r[2];b=(b=c("useMAWTriggerOnDemandCutover")({threadKey:(b=q==null?void 0:q.threadKey)!=null?b:n,triggerSource:"chatTab"}))!=null?b:!1;a=c("gkx")("5578")&&d("MWV2EnsureThatChatTabExists").isOptimisticSecureThread(n,a.threadType,o)&&(q==null||(l||(l=d("I64"))).equal(q.authorityLevel,(k||(k=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC)));if(q!=null&&d("LSMessagingThreadTypeUtil").isOpenOneToOne(q.threadType)&&!u||b||a)return e?null:m.jsx(c("MWV2ChatTabLoadingWithGlimmers.react"),{tab:g});return q!=null?c("gkx")("3795")?m.jsx(c("LegacyHidden"),{"data-testid":void 0,mode:e?"hidden":"visible",children:m.jsx(w,{isMinimized:e,otherContactIdForDefaultE2eeThread:r,shouldUseDefaultE2eeOneToOne:q!=null&&d("LSMessagingThreadTypeUtil").isOpenOneToOne(q.threadType)&&s,tab:g,thread:q,threadLinkHash:p})}):m.jsx("div",{className:(i||(i=c("stylex")))(e?y.hidden:void 0),"data-testid":void 0,children:m.jsx(w,{isMinimized:e,otherContactIdForDefaultE2eeThread:r,shouldUseDefaultE2eeOneToOne:q!=null&&d("LSMessagingThreadTypeUtil").isOpenOneToOne(q.threadType)&&s,tab:g,thread:q,threadLinkHash:p})}):null}e.displayName=e.name+" [from "+f.id+"]";a=o(e);g["default"]=a}),98);